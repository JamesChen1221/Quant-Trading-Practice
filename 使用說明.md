# 美股當沖量化交易 RSI/ADX 計算系統 - 使用說明

## 功能概述

本系統可以自動計算股票的技術指標，包括：
- **RSI (相對強弱指標)**：5天和30天序列
- **ADX (平均趨向指標)**：5天和30天序列

## 快速開始

### 1. 安裝依賴套件

```bash
pip install -r requirements.txt
```

### 2. 準備 Excel 檔案

確保你的 Excel 檔案（`量化交易.xlsx`）包含以下欄位：
- `公司代碼`：股票代號（如 NVDA, TSLA）
- `開盤日期(台灣時間)`：交易日期
- `5天 RSI 序列`、`1個月 RSI 序列`
- `5天 ADX 序列`、`1個月 ADX 序列`

### 3. 執行程式

```bash
python calculate_indicators.py
```

## 執行流程

1. **啟動程式**：
   ```bash
   python calculate_indicators.py
   ```

2. **自動處理**：
   - 程式會自動跳過已有資料的項目
   - 只計算新增或未完成的項目
   - 保留 Excel 原有格式

3. **查看結果**：
   - 開啟 `量化交易.xlsx`
   - 檢查計算結果

## 注意事項

### 關於資料來源

- 使用 Yahoo Finance 免費獲取股價資料
- 完全免費，無需 API Key
- 需要網路連線

### 資料要求

- 建議使用歷史日期（至少 30 個交易日之前）
- 確保股票代號正確（美股代號）
- 日期格式：YYYY-MM-DD

### Excel 格式保留

- 程式使用 `openpyxl` 直接操作儲存格
- 完全保留原有格式（字型、顏色、日期格式等）
- 只更新需要修改的特定儲存格

### 增量計算

- 程式會自動檢查已有資料
- 跳過已計算完成的項目
- 只處理新增或未完成的項目
- 大幅提升處理速度

## 常見問題

### Q1: 為什麼結果是空序列 []？

**原因**：
- 開盤日期可能是今天或未來日期
- 該股票沒有足夠的歷史資料

**解決方法**：
- 使用歷史日期（建議至少 30 天前）
- 確認股票代號正確

### Q2: 如何只計算特定股票？

**方法**：
- 在 Excel 中刪除不需要的行
- 或將已計算的資料保留（程式會自動跳過）

### Q3: 序列的排序是什麼？

**排序方式**：從最遠到最近
- 例如：`[第5天前, 第4天前, 第3天前, 第2天前, 第1天前]`
- 這樣的排序方便機器學習模型使用

### Q4: 可以修改計算週期嗎？

**可以**：
- 編輯 `calculate_indicators.py`
- 修改 `calculate_rsi()` 和 `calculate_adx()` 中的 `period` 參數
- 預設都是 14 天（業界標準）

## 指標解讀

### RSI (相對強弱指標)
- **> 70**：超買區，可能回調
- **< 30**：超賣區，可能反彈
- **50**：中性區

### ADX (平均趨向指標)
- **> 25**：強趨勢
- **< 20**：弱趨勢或盤整
- **> 50**：非常強的趨勢

## 相關文件

- [技術說明 - RSI/ADX 計算](技術說明_RSI_ADX計算.md)
- [執行說明](執行說明.md)
- [範例資料說明](範例資料說明.md)

## 技術支援

如有問題，請參考相關文件或檢查：
1. Python 版本（建議 3.8+）
2. 依賴套件是否正確安裝
3. Excel 檔案格式是否正確
4. 網路連線是否正常
