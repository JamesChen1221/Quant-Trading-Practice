# 資料檔案說明

## 📊 Excel 資料檔案結構

本專案需要一個 Excel 檔案作為資料庫，檔案名稱為 `量化交易.xlsx`。

### 工作表結構

檔案應包含兩個工作表：

#### 1. 資料定義（可選）
用於記錄欄位定義和說明。

#### 2. 資料庫（必要）
主要資料表，包含以下欄位：

| 欄位名稱 | 資料類型 | 說明 | 範例 |
|---------|---------|------|------|
| 開盤日期(台灣時間) | 日期 | 股票開盤日期 | 2026-02-03 |
| 公司代碼 | 文字 | 美股代號 | NVDA, AAPL, TSLA |
| 產業 | 數字 | 產業分類代碼 | 1, 2, 3 |
| 盤前漲幅 (%) | 數字 | 盤前漲跌幅 | 2.5 |
| 相對成交量 (RVOL) | 數字 | 相對成交量 | 1.5 |
| 5日高價距離 (%) | 數字 | 距離5日高價百分比 | -2.3 |
| 5日低價距離 (%) | 數字 | 距離5日低價百分比 | 5.6 |
| 1個月高價距離 (%) | 數字 | 距離1個月高價百分比 | -5.2 |
| 1個月低價距離 (%) | 數字 | 距離1個月低價百分比 | 8.9 |
| **5天 RSI 序列** | 文字 | **程式自動填入** | [73.66, 82.70, ...] |
| **5天 ADX 序列** | 文字 | **程式自動填入** | [27.95, 28.37, ...] |
| **1個月 RSI 序列** | 文字 | **程式自動填入** | [...] |
| **1個月 ADX 序列** | 文字 | **程式自動填入** | [...] |
| 觸發類型 | 數字 | 1=財報, 2=消息, 3=兩者 | 1 |
| 消息情緒分數 | 數字 | -1.0 到 +1.0 | 0.5 |
| 備註 | 文字 | 其他說明 | - |
| EPS Surprise (%) | 數字 | EPS 驚喜百分比 | 5.2 |
| Revenue Surprise (%) | 數字 | 營收驚喜百分比 | 3.1 |
| 展望 (Guidance) | 數字 | 1=調升, 0=持平, -1=調降 | 1 |
| 開盤價變動 (%) | 數字 | 開盤價變動百分比 | 1.2 |
| 10分鐘洗盤深度 (%) | 數字 | 開盤10分鐘最低點 | -0.5 |
| 2小時獲利潛力 (%) | 數字 | 開盤2小時最高點 | 3.2 |
| 2小時風險回撤 (%) | 數字 | 開盤2小時最低點 | -1.1 |
| 2小時結束漲跌 (%) | 數字 | 開盤2小時收盤價 | 1.8 |

---

## 🔒 資料安全

### 為什麼不上傳 Excel 檔案？

1. **隱私保護**：避免交易資料外洩
2. **檔案大小**：Excel 檔案可能很大
3. **個人化資料**：每個人的資料不同
4. **安全性**：避免敏感資訊暴露

### Git 設定

`.gitignore` 已設定忽略所有 `.xlsx` 檔案：

```gitignore
# 資料檔案（避免上傳敏感資料到 GitHub）
量化交易.xlsx
交易資料*.xlsx
*.xlsx

# 但保留範例檔案（如果有的話）
!範例*.xlsx
!example*.xlsx
```

---

## 📝 建立自己的資料檔案

### 方法 1：手動建立

1. 開啟 Excel
2. 建立兩個工作表：「資料定義」和「資料庫」
3. 在「資料庫」工作表中建立上述欄位
4. 填入股票代碼和開盤日期
5. 儲存為 `量化交易.xlsx`

### 方法 2：使用程式建立（推薦）

執行以下 Python 程式碼：

```python
import pandas as pd

# 建立欄位
columns = [
    '開盤日期(台灣時間)', '公司代碼', '產業', '盤前漲幅 (%)', 
    '相對成交量 (RVOL)', '5日高價距離 (%)', '5日低價距離 (%)', 
    '1個月高價距離 (%)', '1個月低價距離 (%)', '5天 RSI 序列', 
    '5天 ADX 序列', '1個月 RSI 序列', '1個月 ADX 序列', '觸發類型', 
    '消息情緒分數', '備註', 'EPS Surprise (%)', 'Revenue Surprise (%)', 
    '展望 (Guidance)', '開盤價變動 (%)', '10分鐘洗盤深度 (%)', 
    '2小時獲利潛力 (%)', '2小時風險回撤 (%)', '2小時結束漲跌 (%)'
]

# 建立空白資料框
df = pd.DataFrame(columns=columns)

# 新增範例資料（可選）
df.loc[0] = ['2026-02-03', 'NVDA', None, None, None, None, None, 
             None, None, None, None, None, None, None, None, None, 
             None, None, None, None, None, None, None, None]

# 儲存為 Excel
with pd.ExcelWriter('量化交易.xlsx', engine='openpyxl') as writer:
    df.to_excel(writer, sheet_name='資料庫', index=False)
    
    # 建立資料定義工作表（可選）
    definition = pd.DataFrame({
        '欄位名稱': ['開盤日期(台灣時間)', '公司代碼'],
        '說明': ['股票開盤日期', '美股代號']
    })
    definition.to_excel(writer, sheet_name='資料定義', index=False)

print("已建立 量化交易.xlsx")
```

### 方法 3：從範例複製

如果有提供範例檔案：

1. 複製 `範例_量化交易.xlsx`
2. 重新命名為 `量化交易.xlsx`
3. 修改內容為自己的資料

---

## 🚀 使用流程

1. **建立資料檔案**
   ```
   量化交易.xlsx
   └── 資料庫（工作表）
       ├── 開盤日期(台灣時間)
       ├── 公司代碼
       └── ... 其他欄位
   ```

2. **填入基本資料**
   - 開盤日期
   - 公司代碼
   - 其他已知資料（可選）

3. **執行程式**
   ```bash
   python calculate_indicators.py
   ```

4. **查看結果**
   - 開啟 Excel
   - 檢查 RSI/ADX 序列欄位
   - 已自動填入計算結果

---

## 📋 範例資料

### 最小範例

只需要填入這兩個欄位即可：

| 開盤日期(台灣時間) | 公司代碼 |
|-------------------|---------|
| 2026-02-03        | NVDA    |
| 2026-02-03        | AAPL    |
| 2026-02-04        | TSLA    |

程式會自動計算並填入：
- 5天 RSI 序列
- 5天 ADX 序列
- 1個月 RSI 序列
- 1個月 ADX 序列

---

## ⚠️ 注意事項

1. **檔案名稱**：必須是 `量化交易.xlsx`
2. **工作表名稱**：必須有「資料庫」工作表
3. **欄位名稱**：必須包含「開盤日期(台灣時間)」和「公司代碼」
4. **日期格式**：YYYY-MM-DD（如 2026-02-03）
5. **股票代碼**：美股代號（如 NVDA, AAPL, TSLA）

---

## 🔄 從 GitHub 下載後的設定

如果你從 GitHub 下載了這個專案：

1. **建立資料檔案**
   - 參考上述方法建立 `量化交易.xlsx`
   - 或使用自己現有的資料檔案

2. **確認 .gitignore**
   - 確保 `.gitignore` 包含 `*.xlsx`
   - 這樣你的資料不會被意外上傳

3. **開始使用**
   ```bash
   pip install -r requirements.txt
   python calculate_indicators.py
   ```

---

## 💡 最佳實踐

1. **定期備份**
   - 定期備份 `量化交易.xlsx` 到其他位置
   - 不要依賴 Git 來備份資料檔案

2. **版本管理**
   - 可以手動建立備份：`量化交易_20260203.xlsx`
   - 或使用雲端硬碟同步

3. **資料安全**
   - 不要將包含真實交易資料的檔案上傳到公開倉庫
   - 如需分享，建立範例檔案並移除敏感資訊

---

## 📚 相關文件

- **README.md** - 專案說明
- **使用說明.md** - 使用指南
- **執行說明.md** - 執行說明
- **Git使用指南.md** - Git 教學

---

**重要提醒**：`量化交易.xlsx` 不會被上傳到 GitHub，請妥善保管你的本地檔案！
