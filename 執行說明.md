# 執行說明

## 快速開始

### 1. 安裝依賴套件

```bash
pip install -r requirements.txt
```

### 2. 執行程式

```bash
python calculate_indicators.py
```

## 執行範例

```bash
$ python calculate_indicators.py

============================================================
美股技術指標計算系統 - RSI & ADX
============================================================

計算指標：
  ✓ RSI (相對強弱指標) - 5天和30天序列
  ✓ ADX (平均趨向指標) - 5天和30天序列

資料來源：Yahoo Finance (免費)
============================================================

正在讀取 量化交易.xlsx 的 '資料庫' 工作表...
Excel 欄位: ['公司代碼', '開盤日期(台灣時間)', ...]
共有 10 筆資料

處理第 1 筆: NVDA (日期: 2025-12-15)
  正在下載 NVDA 的資料...
  ✓ 完成 (實際資料: 45 天)
  RSI 5天前3筆: [65.23, 67.45, 69.12]
  ADX 5天前3筆: [28.39, 27.57, 28.36]

處理第 2 筆: AAPL (日期: 2025-12-15)
  正在下載 AAPL 的資料...
  ✓ 完成 (實際資料: 45 天)
  RSI 5天前3筆: [52.34, 54.12, 56.78]
  ADX 5天前3筆: [22.15, 23.45, 24.67]

============================================================
處理完成統計:
  新計算: 2 筆
  已跳過: 8 筆（已有資料或資料不完整）
  失敗: 0 筆
  總計: 10 筆
============================================================

正在更新 量化交易.xlsx 的 '資料庫' 工作表（保留原有格式）...
✓ 完成！格式已保留。

提示：
  - 序列排序為從最遠到最近 [第5天前, ..., 第1天前]
  - RSI > 70: 超買，RSI < 30: 超賣
  - ADX > 25: 強趨勢，ADX < 20: 弱趨勢
```

## 輸出結果

程式執行完成後，會在 Excel 中填入以下欄位：
- `5天 RSI 序列`：過去 5 天的 RSI 值
- `1個月 RSI 序列`：過去 30 天的 RSI 值
- `5天 ADX 序列`：過去 5 天的 ADX 值
- `1個月 ADX 序列`：過去 30 天的 ADX 值

## 注意事項

1. **Excel 格式保留**：程式會完全保留 Excel 原有格式
2. **增量計算**：已有資料的項目會自動跳過
3. **序列排序**：從最遠到最近 `[第5天前, ..., 第1天前]`
4. **免費使用**：完全免費，無需 API Key

## 常見問題

### Q: 如何重新計算某支股票？

**A**: 刪除 Excel 中該股票的 RSI/ADX 欄位內容，重新執行程式

### Q: 可以批次處理多支股票嗎？

**A**: 可以，在 Excel 中新增多行資料，執行一次程式即可全部計算

### Q: 程式執行很慢怎麼辦？

**A**: 
- 確認網路連線正常
- Yahoo Finance 可能暫時限流，稍後再試
- 減少一次處理的股票數量

### Q: 支援台股嗎？

**A**: 目前只支援美股代號（如 NVDA, AAPL），不支援台股代號（如 2330）

## 相關文件

- [使用說明](使用說明.md) - 完整使用指南
- [技術說明](技術說明_RSI_ADX計算.md) - 計算公式和邏輯
- [範例資料說明](範例資料說明.md) - Excel 資料格式
