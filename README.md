# 美股當沖量化交易系統

自動計算美股技術指標，用於盤前分析和當沖交易決策。

## 功能

- **RSI (相對強弱指標)**: 5天、30天、6個月序列
- **ADX (平均趨向指標)**: 5天、30天、6個月序列  
- **價格距離**: 昨日收盤價距離過去高低點的百分比（5日、30日、6個月）
- **盤中數據**: 開盤價、10分鐘最低價、1.5小時最高價、最高價前的最低價
  - ⚠️ 盤中數據僅限最近 7 天（yfinance 免費版限制）

## 安裝

```bash
pip install -r requirements.txt
```

## 使用方法

1. 準備 Excel 文件 `量化交易.xlsx`，包含工作表 `資料庫`
2. 確保表格包含以下欄位：
   - `公司代碼`: 股票代號（如 NVDA）
   - `開盤日期`: 交易日期
   - RSI/ADX 序列欄位
   - 價格距離欄位（可選）
   - 盤中價格欄位（可選）

3. 執行程式：

```bash
python calculate_indicators.py
```

程式會自動：
- 從 Yahoo Finance 下載股價資料
- 計算所有技術指標
- 更新 Excel 文件（保留原有格式）
- 跳過已有資料的項目（增量計算）

## 注意事項

- 所有數值四捨五入到 1 位小數
- 序列排序從最遠到最近：`[第N天前, ..., 第1天前]`
- 盤中數據只能獲取最近 7 天的資料
- 程式會自動保留 Excel 格式（字型、顏色、粗體等）

## 技術指標說明

- **RSI > 70**: 超買，**RSI < 30**: 超賣
- **ADX > 25**: 強趨勢，**ADX < 20**: 弱趨勢
- **價格距離**: 正值表示高於參考價，負值表示低於參考價

## 資料來源

Yahoo Finance (免費)
