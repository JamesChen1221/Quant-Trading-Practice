# 美股當沖量化交易 - RSI & ADX 指標計算系統

自動計算美股技術指標（RSI、ADX）的 Python 工具，用於量化交易分析。

## 📊 功能特色

- ✅ 自動從 Yahoo Finance 下載股價資料
- ✅ 計算 RSI (相對強弱指標) 和 ADX (平均趨向指標)
- ✅ 生成 5 天和 30 天的技術指標序列
- ✅ 增量計算：自動跳過已有資料
- ✅ Excel 格式保留：不破壞原有格式設定
- ✅ 支援批次處理多支股票

## 🚀 快速開始

### 1. 安裝依賴

```bash
pip install -r requirements.txt
```

### 2. 建立資料檔案

**方法 A：使用範本建立工具（推薦）**

```bash
python create_template.py
```

這會建立一個包含所有必要欄位的 `量化交易.xlsx` 檔案。

**方法 B：手動建立**

參考 [範例資料說明.md](範例資料說明.md) 手動建立 Excel 檔案。

### 3. 填入資料

在 `量化交易.xlsx` 的「資料庫」工作表中填入：
- 開盤日期(台灣時間)：如 2026-02-03
- 公司代碼：如 NVDA, AAPL, TSLA

### 4. 執行程式

```bash
python calculate_indicators.py
```

程式會：
1. 讀取「量化交易.xlsx」的「資料庫」工作表
2. 計算每支股票的 RSI 和 ADX 序列
3. 將結果寫回 Excel（保留原有格式）

## ⚠️ 重要提醒

**資料檔案不會上傳到 GitHub**

- `量化交易.xlsx` 已加入 `.gitignore`
- 你的交易資料只保存在本地
- 從 GitHub 下載專案後需要自行建立資料檔案

詳細說明請參考：[範例資料說明.md](範例資料說明.md)

## 📁 檔案結構

```
.
├── calculate_indicators.py          # 主程式
├── create_template.py               # 建立 Excel 範本工具
├── requirements.txt                 # Python 套件依賴
├── 量化交易.xlsx                    # 資料檔案（不會上傳到 GitHub）
├── README.md                        # 本檔案
├── 使用說明.md                      # 一般使用說明
├── 執行說明.md                      # 執行指南
├── 範例資料說明.md                  # Excel 資料檔案說明
├── 技術說明_RSI_ADX計算.md          # 技術細節和公式
├── 更新說明.md                      # 更新記錄
├── 格式保留說明.md                  # Excel 格式保留說明
├── Git使用指南.md                   # Git 完整教學
└── Git快速參考.md                   # Git 快速參考
```

## 📊 資料格式

### 輸入（Excel「資料庫」工作表）

| 開盤日期(台灣時間) | 公司代碼 | ... |
|-------------------|---------|-----|
| 2026-02-03        | TER     | ... |
| 2026-02-03        | PLTR    | ... |

### 輸出（自動填入）

| 5天 RSI 序列 | 5天 ADX 序列 | 1個月 RSI 序列 | 1個月 ADX 序列 |
|-------------|-------------|---------------|---------------|
| [73.66, 82.70, ...] | [27.95, 28.37, ...] | [...] | [...] |

## 🔧 技術參數

- **RSI 週期**：14 天（業界標準）
- **ADX 週期**：14 天（業界標準）
- **序列排序**：從過去到現在 [第5天前, ..., 第1天前]
- **資料來源**：Yahoo Finance

## 📖 詳細文件

- **[範例資料說明.md](範例資料說明.md)** - Excel 資料檔案結構和建立方法
- **[使用說明.md](使用說明.md)** - 基本使用方式
- **[執行說明.md](執行說明.md)** - 執行指南和注意事項
- **[技術說明_RSI_ADX計算.md](技術說明_RSI_ADX計算.md)** - 計算公式和邏輯
- **[格式保留說明.md](格式保留說明.md)** - Excel 格式保留技術
- **[更新說明.md](更新說明.md)** - 版本更新記錄
- **[Git使用指南.md](Git使用指南.md)** - Git 完整教學
- **[Git快速參考.md](Git快速參考.md)** - Git 常用指令

## 💡 使用範例

### 新增資料

1. 在 Excel「資料庫」工作表中新增一行
2. 填入股票代碼（如 NVDA）和開盤日期
3. 執行 `python calculate_indicators.py`
4. 程式自動計算並填入結果

### 批次處理

1. 一次新增多筆資料
2. 執行一次程式
3. 所有新資料都會自動計算

### 重新計算

1. 刪除 Excel 中的 RSI/ADX 欄位內容
2. 執行程式
3. 程式會重新計算該筆資料

## 🎯 指標解讀

### RSI (相對強弱指標)
- **> 70**：超買區，可能回調
- **< 30**：超賣區，可能反彈
- **50**：中性區

### ADX (平均趨向指標)
- **> 25**：強趨勢
- **< 20**：弱趨勢或盤整
- **> 50**：非常強的趨勢

## ⚙️ 系統需求

- Python 3.10+
- 網路連線（下載股價資料）
- Excel 2010+ 或相容軟體

## 📝 依賴套件

- yfinance - 股價資料下載
- pandas - 資料處理
- openpyxl - Excel 操作
- numpy - 數值計算

## 🔄 版本記錄

### v1.0.0 (2026-02-05)
- ✅ 初始版本
- ✅ RSI/ADX 計算功能
- ✅ 增量計算功能
- ✅ Excel 格式保留
- ✅ 序列排序調整（從過去到現在）

## 📄 授權

本專案僅供個人學習和研究使用。

## 🤝 貢獻

歡迎提出問題和建議！

## ⚠️ 免責聲明

本工具僅供技術分析參考，不構成投資建議。投資有風險，請謹慎決策。

---

**開發日期**：2026-02-05  
**版本**：v1.0.0
